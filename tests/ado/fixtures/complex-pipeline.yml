# Pipeline URL: https://dev.azure.com/RussellBoley/ado-mcp/_build?definitionId=84
name: slow.log-test-complex

trigger: none

pool:
  vmImage: ubuntu-latest

variables:
  - name: buildConfiguration
    value: 'Release'
  - name: appVersion
    value: '1.0.0'

resources:
  repositories:
    - repository: tooling
      type: github
      name: raboley/tooling
      endpoint: raboley
      ref: refs/heads/main

jobs:
  - template: /.ado/jobs/fast.job.yml@tooling
    parameters:
      name: ParameterizedJob

stages:
  - stage: Validate
    displayName: 'Validation Stage'
    jobs:
      - template: /.ado/jobs/fast.job.yml@tooling
        parameters:
          name: ParameterizedJob
            
  - stage: Build
    displayName: 'Build Stage'
    dependsOn: Validate
    jobs:
      - job: CompileJob
        displayName: 'Compile Application'
        steps:
          - script: |
              echo "Running unit tests..."
              echo "Test 1: PASS"
              echo "Test 2: PASS"  
              echo "Test 3: FAIL - Assertion error in UserService.validateEmail()"
              echo "ERROR: 1 out of 3 tests failed"
              exit 1
            displayName: 'Unit Tests'
            
      - job: PackageJob
        displayName: 'Package Application'
        dependsOn: CompileJob
        condition: succeeded()
        steps:
          - script: echo "This should not run due to compilation failure"
            displayName: 'Create Package'

  - stage: Test
    displayName: 'Testing Stage'
    dependsOn: Build
    jobs:
      - job: IntegrationTests
        displayName: 'Integration Testing'
        steps:
          - script: echo "This should not run due to build failure"
            displayName: 'Run Integration Tests'